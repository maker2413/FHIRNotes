#+TITLE: Understanding Interoperability, HL7, and Related Standards

Before diving right into HL7 it will help to go over some of the history and
learn how we got to where we are today. In the 1970s the idea of integrated
Health Information Systems was born. Initially, these systems focused on the
financial and administrative aspects of healthcare. Eventually there was a shift
in focus - a shift towards patient-centered care. The goal was to integrate the
vast amount of information scattered across numerous healthcare records into one
cohesive system. However, early attempts faced a major roadblock - the
technology of the time was not advanced enough.

Fast forward to today, and the landscape has dramatically changed. The
transformation has been fueled by the concept of
interoperability. Interoperability means different things, but the most widely
used definition is "The ability of two or more systems or components to
interchange information and predictably use the information that has been
exchanged." In the context of healthcare this seamless flow is vital.

Throughout your healthcare journey you might visit different specialists, get
treatment at various healthcare facilities, and your records could be with
different healthcare providers and payers.

The benefits of interoperability improve:
- Efficiency
- Quality
- Safety

With interoperability systems, the attending physicians can access the patient's
medical history, allergies, medications, and previous diagnoses promptly. This
instant access to comprehensive information can be life-saving, especially in
critical situations.

The world of healthcare has different levels of interoperability:
- Foundational (Technical): Making sure different healthcare systems or apps can
  talk to each other securely, using the same communication channels and network
  protocols.
- Structural (Syntactic): Defines the format, syntax, and organization of data
  sharing.
- Semantic: Using specific medical terms, known as concepts, to make sure
  information is easily shared across different systems. For instance there are
  languages like:
  - SNOMED CT: contains more than 360,000 medical terms acting like a universal
    translator for medical data.
  - LOINC: more than 100,000 terms for lab results.
  - ICD: more than 120,000 codable terms for diagnoses.
- Organizational: This involves aligning business rules, policies, legal
  frameworks, workflows, and institutional practices.

When it comes to reaching the various levels of interoperability Healthcare
Standards step in to make it happen. There are five essential categories of
standards:
- Transport: Deals with how data is physically moved from one place to another.
- Privacy and Security: Set the rules and protocols for safeguarding patient
  information.
- Content: Define the structure and format of data being exchanged.
- Identifier: Unique serial numbers for different elements in the healthcare
  system whether it's patients, healthcare providers, or specific medical
  devices.
- Vocabulary/Terminology: Agreed-upon dictionary of medical terms.

* HL7v2 Messaging Standard
  In the world of healthcare, there are lots of rules or standards that
  different processes have to follow. These standards can vary depending on
  region and purpose. One of the important standards is called HL7
  version 2. This standard has been around for more than 35 years and still
  plays a major role in healthcare.

  To really understand what makes HL7v2 special let's take a trip back to 1987,
  when the first version of the HL7 standard was developed. It's original
  purpose to support the exchange of patient admission, discharge, and transfer
  information. This led to the creation of ADT message types. Then in 1988 the
  initial version of the HL7v2 was officially released, incorporating orders and
  reports.

  The most recent version available on the HL7 website is version 2.9. And
  here's an interesting point: HL7v2 didn't appear out of thin air it was
  influenced by standards used in adjacent industries. In fact, it shares
  similarities with the ANSI X12 standard.

  This course will not go over the HL7v2 syntax in full detail, but instead we
  will go over a brief overview of its development methodology, which eventually
  set the stage for the FHIR standard.

  The HL7v2 development approach is centered around the Message Framework, a set
  of guidelines that define how v2 messages are structured and populated. The
  heart of the message framework is:
  - Message Types: HL7v2 defines approximately 115 distinct message types. Each
    message type follows a hierarchical format, built from required or optional
    segments and segment groups.
  - Segments: A logical grouping of data fields related to a specific
    function. For example, the PID or Patient Identification segment contains
    key patient information, such as permanent identifiers and demographic
    details. HL7v2 includes around 180 segments, which are assembled depending
    on the message type structure.
  - Fields: Contain a specific set of data elements and uses a defined data
    type. Fields can behave in ways that are sometimes confusing, for example a
    field can be populated, not populated, or set to null. A field can also be
    required, optional, or "Required But Empty".

  Let's briefly go over the HL7v2 Development Framework, which is related to the
  message structure development:
  - Backward Compatibility: The central principle of the development
    framework.
  - Accommodating Changes: This means, among other rules, that
    - New message types can be introduced
    - New segments can be added to existing message types
    - New data types can be introduced
    - Existing segments can be expanded by adding new fields at the end
    - Existing data types can have new components appended at the end.
  - Local Extensions: With the complexity of the medical world a
    "one-size-fits-all" message doesn't always work:
    - Custom message types
    - Custom segements (Z segments)
    - Custom data types

  Manually building HL7v2 messages - especially counting pipes - is tedious and
  error-prone. To streamline this, specialized v2 tools were created:
  - Editors: supports viewing, editing, and sending HL7v2 messages using the
    MLLP, or the Minimal Lower Layer Protocol. MLLP provides a simple framework
    mechanism for reliably sending v2 messages over a TCP/IP connection.
  - Specification Authoring: Not many tools were developed to help implementers
    automate HL7v2 specification development.

  Due to how configurable the HL7v2 message structure is this led to the rise of
  the joke: "Once you have seen one HL7v2 message structure you have only seen
  that one HL7v2 message structure". To address these challenges, HL7
  International began developing version 3 of the HL7 standard.

* HL7v3 Messaging structure
  While HL7v2 was a major breakthrough in making healthcare communication more
  standardized, over time it became clear a that a more structured approach was
  needed. By the late 1990s the HL7 organization recognized the need for a more
  robust standard that could handle the evolving complexities of healthcare
  systems. At the same time object-oriented programming was gaining widespread
  adoption, thanks to languages like C++ and Java.

  HL7v3 development began with a focus on creating a standardized framework for
  healthcare data exchange, incorporating advanced concepts from object-oriented
  programming and formal modeling techniques. The core of version 3 became of
  the Reference Information Model, or RIM.

  The RIM is a formal, abstract model that defines the structure and semantics
  of HL7v3 messages. Put simply it uses the concept of "classes" to represent
  core elements of healthcare data. There are four main classes:
  - Entity
  - Role
    - Role Link: subclass and interconnected to Role
  - Participation
  - Act
    - Act Relationship: subclass and interconnect to Act

  The RIM model is intentionally abstract, designed to support a wide variety of
  healthcare workflows. Feel free to take a moment to look over RIM:
  [[./RIM.png]]

  Let's take a look at how the message development process was structured in
  v3. This is a general breakdown of the v3 refinement process:
  - Refinement: Allows standard definitions to be customized or enhanced to
    better align with the specific needs of a given healthcare setting.
  - Constraint: Gradually narrow the scope of a specification by building
    additional models based on existing ones.

** HL7v3 Message building
   But how are version 3 message types actually built? It all starts with
   refining and constraining the RIM into what's called a Domain Message
   Information Model, or D-MIM.

   The D-MIM defines the specific classes, attributes, and relationships required
   for a particular healthcare domain. There are about 25 such domains, covering
   a wide range of areas - including clinical observations, immunizations,
   medications, claims, and more.

   Next to build messages containing actual clinical data for a given domain,
   the D-MIM undergoes further refinement into one or more Refined Message
   Information Models, or R-MIMs.

   Finally the same process applies additional constraints to produce
   Hierarchical Message Descriptions, or HMDs, and, ultimately, the actual
   version 3 message type specifications.

** XML Implementation
   What we have just covered is primarily intended for standards developers and
   are not used by the software developers who actually build the systems. To
   bridge the gap, the version 3 standard includes the XML Implementation
   Technology Specification, or XML ITS, which explains how HMDs are serialized
   into XML Schemas and transmitted over the network.

** Popularity
   To address the shortcoming of version 2 of HL7 version3 was created with a
   fully re imagined architecture centered on the RIM. While version 3
   introduced rich clinical semantics, handled complex healthcare topics well,
   and included a full set of application authoring tools, it ultimately saw
   limited adoption despite significant efforts from healthcare IT
   professionals.

   One major issue was that the v3 models and messages turned out to be more
   complex than anticipated. To make matters more difficult, the localization
   process added another layer of complexity, often requiring developers to
   piece together information from multiple sources just to interpret a message.

   Version 3 still had a lasting impact - many of its design principles helped
   shape the FHIR standard. And while much of v3 wasn't widely adopted, one part
   of it has become extremely successful.

* CDA
  Even though HL7 version 3 RIM was designed to be clinically rich, it hasn't
  seen widespread adoption in real-world healthcare settings. Despite extensive
  effort from healthcare professionals, its complexity exceeded expectations,
  limiting its practical uptake. However, one domain of version 3 gained
  significant popularity - Clinical Document Architecture or CDA.

  Unlike other domains of v3, CDA focused on organizing medical documents in a
  structured, standardized way, which made sharing crucial patient information 
  easier. It's worth noting that CDA is often confused with the Continuity of Care
  Document or CCD.

** What exactly is CDA?
   The Clinical Document Architecture is a document markup standard that
   specifies the structure and semantics of "clinical documents" for the purpose
   of exchange. In other words, CDA provides guidance on how clinical reports
   should be formatted and interpreted to enable consistent information exchange
   between systems.

   What sets CDA apart from the messages is that clinical documents must meet
   the following characteristics:
   - Persistence: A clinical document remains unchanged for a specific period,
     as determined by local and regulatory rules.
   - Stewardship: An organization responsible for it takes care of a clinical
     document.
   - Potential for authentication: A clinical document is a set of period
     related information intended to be officially verified and approved.
   - Context: A clinical document sets the initial context for what's inside it.
   - Wholeness: Authentication of a clinical document covers the entire document
     and doesn't apply to specific parts without considering the whole context.
   - Human readability: A clinical document should be easily readable and
     understandable for users.

   Unlike the HL7v3 process of refinement and constraint the CDA process skips
   the refinement steps from the RIM to the D-MIM and goes straight to the
   R-MIM. Here is an image that shows what the CDA R-MIM looks like. Feel free
   to look over this image to get a general idea of the CDA R-MIM:
   [[./CDA_R-MIM.gif]]

   There are two main components to the CDA R-MIM:
   - The header (left half of image): Establishes the context for the entire
     document. It is responsible for identifying and classifying the document,
     and for providing key details such as patient, provider, encounter, and
     authentication information.
   - The body (right half of image): Contains the clinical context, divided into
     sections, each potentially with narrative blocks, structured entries, or
     external references.

   After this the CDA Hierarchical Description (CDA HD) is generated from the
   R-MIM. The HD contains conformance rules and serves as the foundation for
   generating XML schemas via XML ITS. The resulting CDA XML schemas are
   normative, meaning that every CDA document must pass XML schema validation to
   be considered valid.

   Even though the CDA R-MIM is relatively limited in scope, it remains highly
   expressive and flexible - sometimes too much so. To make it more practical
   for clinical use additional constraints are applied at three levels:
   1. CDA Level 1: The most basic form of CDA. It includes only the document
      header, which provides general information about the clinical
      document. The body is unstructured and typically contains human-readable
      content in proprietary formats like PDF.
   2. CDA Level 2: This level introduces section-level templates. These
      templates organize the content in a more structured format, similar to
      HTML, and allow sections to be labeled using coded terminology.
   3. CDA Level 3: At the third level, CDA includes entry-level templates that
      add machine-readable data elements to the sections. This makes the
      document not only understandable to humans but also processable by
      computers, enabling true semantic interoperability.

** Consolidated CDA
   Consolidated CDA, or C-CDA. In the early 2000s, several Standards Development
   Organizations - including HL7, ASTM, IHE, the US ONC, and others - were
   working on overlapping clinical document standards. To streamline clinical
   document exchange, they joined forces in a harmonization effort that led to
   the creation of the Consolidated Clinical Document Architecture, also known
   as C-CDA.

   C-CDA is a collection of standardized document, section, and entry-level
   templates. Initially driven by the US ONC, it was tailored to meet the needs
   of the US healthcare system. C-CDA has undergone multiple updates and
   enhancements to address technical challenges and improve interoperability,
   with input from providers, EHR vendors, and SDOs.

   The current version, C-CDA 4.0, includes approximately a dozen document
   templates - among them the widely used Continuity of Care Document or CCD.

** C-CDA Sepcification
   At its core, C-CDA is a set of standardized templates at the document,
   section, and entry levels. You might be wondering - what exactly does the
   term "template" mean in this context? As mentioned earlier, CDA supports
   three conformance levels, and the C-CDA specification addresses all three:
   - Document templates: Places constraints on specific fields within the CDA
     header and define how the document's sections should be organized. The
     C-CDA specification includes approximately a dozen document-level
     templates - one of the most widely recognized being the CCD.
   - Section templates: Defines the content structure of each CDA section and
     specify how entries are organized within those sections. The C-CDA
     specification includes around 70 section-level templates, many of which are
     reusable across multiple document-level templates.
   - Entry templates: The C-CDA specification goes beyond section-level
     templates with over a hundred entry-level templates. Examples include
     templates for Age, Observation, Diagnosis, Immunization, and many others.

   Alright, now, you might be thinking "This C-CDA spec is over 900 pages long -
   what's the point?" Well, C-CDA documents are now widely adopted across more
   than 40 HL7 Affiliate countries, including the US, UK, Canada, Germany,
   France, Austria, Greece, Russia, Argentina, Japan, and others. This
   widespread adoption didn't happen by chance. It was largely due to multiple
   SDOs choosing to collaborate rather than compete. By working together to
   create a unified specification, they reduced confusion and made it much
   easier for healthcare providers and IT systems to implement and adopt C-CDA.

   CDA was a major success and became the foundation for the C-CDA
   specification. HL7 and other Standards Development Organizations took the
   feedback seriously - addressing concerns about v3's complexity and the
   challenges of the balloting process.

* OpenEHR
  When discussing the standards that shaped HL7 FHIR, it's essential to include
  openEHR. While these two standards have influenced each other, they were
  created for fundamentally different purposes.

  The primary goal of HL7 standards, and FHIR in particular, is to enable the
  sharing of clinical information. By contrast, openEHR focuses on how clinical
  data is modeled and stored, with particular attention to persistence and
  structure. That said, both standards can support either function, and there
  are real-world implementations that reflect this overlap. However, despite
  their different emphases, openEHR and FHIR share many common principles and
  objectives. In fact, they are often seen as complementary - making healthcare
  data exchange and interoperability better.

  So what exactly is openEHR? It's not just a set of specifications. Instead,
  it's a comprehensive modular architecture that provides core building blocks
  for creating health information systems. The design is vendor-neutral and
  technology-agnostic, making it adaptable, maintainable, and interoperable. It
  focuses on having standardized and computer-friendly data definitions, and
  it's shaped by experts in the healthcare field.

  The key concept in openEHR is its two-level modeling approach, also known as
  the "dual model". At the heart of this approach is the separation of the
  general structure of health data from the clinical knowledge it
  represents. These are divided into two distinct layers:
  - Reference Model: Defines the basic objects and data types, and how they
    relate to each other, independent of any clinical meeting. By keeping
    clinical concepts separate, this model gives software architects the
    flexibility to design systems without embedding domain-specific knowledge
    into the technical structure.
  - Archetype Model: Defines clinical concepts in a structured and standardized
    way using archetypes and templates. It allows clinical content to be
    described precisely, enabling systems to represent and manage clinical
    knowledge effectively.

  Let's now explore each level in more detail.
